``` VB6
'GitHub Account: GitHub.com/AliRezaJoodi
Dim CPN As Byte
Dim buf As Variant
Dim data(4) As Byte
Dim counter As Byte

Private Sub Form_Load()
    MSComm1.Settings = "9600,N,8,1"
    MSComm1.RThreshold = 1
    MSComm1.SThreshold = 1
    MSComm1.InputLen = 1
    Combo1.Clear
    For CPN = 1 To 16
        Combo1.AddItem Str(CPN)
    Next CPN
    Combo1.Text = Combo1.List(0)
    Frame2.Enabled = False
    Frame3.Enabled = False
    Frame4.Enabled = False
    Command_Close.Enabled = False
    Label1.Enabled = False
    Label2.Enabled = False
    Relay.BackColor = RGB(192, 192, 192)
End Sub

Private Sub Command_Open_Click()
    CPN = Val(Combo1.Text): MSComm1.CommPort = CPN
    MSComm1.PortOpen = True
    Command_Close.Enabled = True
    Command_Open.Enabled = False
    Combo1.Enabled = False
    Frame2.Enabled = True
    Frame3.Enabled = True
    Frame4.Enabled = True
    Label1.Enabled = True
    Label2.Enabled = True
End Sub

Private Sub Command_Close_Click()
    MSComm1.PortOpen = False
    Command_Close.Enabled = False
    Command_Open.Enabled = True
    Combo1.Enabled = True
    Frame2.Enabled = False
    Frame3.Enabled = False
    Frame4.Enabled = False
    Label1.Caption = "0"
    Label2.Caption = "0"
    Label1.Enabled = False
    Label2.Enabled = False
    Relay.BackColor = RGB(192, 192, 192)
End Sub

Private Sub MSComm1_OnComm()
    Select Case MSComm1.CommEvent
        Case comEvReceive
            buf = MSComm1.Input
            buf = Asc(buf)
            Debug.Print buf
            If buf = 123 And counter = 0 Then
                counter = 1
                data(counter) = buf
                Exit Sub
            End If
            If counter <> 0 Then
                counter = counter + 1
                data(counter) = buf
                If counter = 4 Then
                    Label1.Caption = Str(data(2))
                    Label2.Caption = Str(data(3))
                    If data(4) = 0 Then Relay.BackColor = RGB(192, 192, 192) Else Relay.BackColor = RGB(255, 0, 0)
                    counter = 0
                End If
            End If
    End Select
End Sub
```
